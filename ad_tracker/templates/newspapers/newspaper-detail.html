{% extends 'site-base.html' %}
{% load staticfiles %}

{% block title %}{{ newspaper.name }}{% endblock %}

{% block content %}

{% if user.is_authenticated %}
  
  <div class="row">
    
    <div class="col col-60">
      <div class="panel">
        <h2>Newspaper: {{ newspaper.name }} <a href="/newspaper/edit/{{ newspaper.id }}/">edit</a></h2>
        <div class="panel-inner">
          <p><strong>City:</strong>&nbsp;&nbsp;{{ newspaper.city }}</p>
          <p><strong>State:</strong>&nbsp;&nbsp;{{ newspaper.state }}</p>
          <hr>
          <p><strong>Contact Name:</strong>&nbsp;&nbsp;{{ newspaper.contact_name }}</p>
          <p><strong>Contact Phone:</strong>&nbsp;&nbsp;{{ newspaper.contact_phone }}</p>
          <p><strong>Contact Email:</strong>&nbsp;&nbsp;{{ newspaper.contact_email }}</p>
        </div>
      </div>
      {% if not ads_all %}
        <p><a href="/newspaper/confirm_delete/{{ newspaper.id }}/">Delete newspaper</a></p>
      {% endif %}
    </div>

    <div class="col col-40">
      <div class="panel">
        <h2>Advertisements</h2>
          {% for ad in ads %}
            <h3><a href="/ad/{{ ad.id }}/">{{ ad.name }}</a></h3>
          {% endfor %}
          {% if not ads %}
            <h3>There are no current advertisements.</h3>
          {% endif %} 
      </div>
    </div>

  </div>
  
  <svg id="chart" width="970" height="500"
    viewBox="0 0 970 500"
    preserveAspectRatio="xMidYMid">
  </svg>
  
  <script type="text/javascript" src="{% static 'js/jquery-2.1.1.min.js' %}"></script>
  <script type="text/javascript" src="{% static 'js/d3.min.js' %}"></script>

  <script type="text/javascript">

    var jsonRects = [
       {
        "x_axis": 30,
        "y_axis": 30,
        "width": 20,
        "height": 10,
        "color" : "green"
       }, {
        "x_axis": 70,
        "y_axis": 70,
       "width": 60,
       "height": 10,
       "color" : "purple"
      }, {
       "x_axis": 110,
       "y_axis": 100,
       "width": 100,
       "height": 10,
       "color" : "red"
    }];

    var chart = d3.select("#chart")
      .style({
        "background": "#DEDCED",
        "border": "1px solid #ccc"
      });

    var rectangles = chart.selectAll("rect")
      .data(jsonRects)
      .enter()
      .append("rect");

    var rectangleAttributes = rectangles
      .attr("x", function (d) { return d.x_axis; })
      .attr("y", function (d) { return d.y_axis; })
      .attr("height", function (d) { return d.height; })
      .attr("width", function (d) { return d.width; })
      .style("fill", function(d) { return d.color; });
    
    var aspect = 970 / 500, chart = $("#chart");
    var targetWidth = chart.parent().width();
    chart.attr("width", targetWidth);
    chart.attr("height", targetWidth / aspect);
    
    $(window).on("resize", function() {
      targetWidth = chart.parent().width();
      chart.attr("width", targetWidth);
      chart.attr("height", targetWidth / aspect);
    });

  </script>

{% endif %}

{% endblock %}
